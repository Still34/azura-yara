# generated using capa explorer for IDA Pro
rule:
  meta:
    name: match Gh0st module
    namespace: malware/apt
    author: still@teamt5.org
    scope: function
    examples:
      - 9A337AC7B5DB402ED98D8958C6CCC17B:0x40A270
  features:
    - or:
      - and:
        - description: CFileManager::MakeSureDirectoryPathExists
        - match: get file attributes
        - match: create directory
        - api: CharNextA
        - number: 0x5C
        - mnemonic: cmp
      - and:
        - description: CFileManager::SendFilesList
        - string: "%s\\*.*"
        - api: FindFirstFile
        - api: kernel32.FindNextFile
        - number: 0x208
      - and:
        - description: CClientSocket::Send
        - bytes: 6A BC 74 93 18 04 F0 3F 00 00
        - number: 0x2000
        - number: 0x5
        - number: 0xFFFFFFFF
        - number: 0x1F
